name: Create Release PR

on:
  push:
    branches:
      - main

  workflow_dispatch:
    inputs:
      release_tag:
        description: 'Release tag to update the chain registry with'
        required: true
        type: string
      deposit:
        description: 'Deposit amount (default: 1000000000uxion)'
        required: false
        default: '1000000000uxion'
        type: string
      expedited:
        description: 'Expedited proposal'
        required: false
        default: false
        type: boolean

jobs:
  create-release-pr:
    runs-on: ubuntu-latest

    env:
      XION_API_URL: "https://api.xion-testnet-2.burnt.com"
      MINTSCAN_CHAIN_ID: "xion-testnet"
      NETWORK_NAME: "xion-testnet-2"
      TARGET_BRANCH: "feat/do-85-generate-upgrade-proposals-n-release-binaries"
      RELEASE_TAG: "v22.0.0"  # TODO: Use ${{ github.event.inputs.release_tag || 'v22.0.0' }}
      DEPOSIT: "${{ github.event.inputs.deposit || '1000000000uxion' }}"
      EXPEDITED: "${{ github.event.inputs.expedited || 'false' }}"
      PLACEHOLDER_CHECKSUM: "--ADD-HERE-YOUR-VALUE--"
      CLAUDE_API_KEY: "${{ secrets.BURNT_CLAUDE_API_KEY }}"
      GITHUB_TOKEN: "${{ secrets.GITHUB_TOKEN }}"
      RUN_NUMBER: "${{ github.run_number }}"
      COMMIT_SHA: "${{ github.sha }}"
      GH_TOKEN: "${{ secrets.GITHUB_TOKEN }}"

    steps:
    - name: Checkout repository
      uses: actions/checkout@v4

    - name: Run release workflow
      run: ./scripts/create-release-workflow.sh
