# Xion v26 Release Notes

## Overview

The Xion v26 release introduces two new modules (DKIM and ZK) for blockchain-based email authentication with zero-knowledge proofs, along with critical security fixes to existing modules. This is a release candidate version (v26.1.0-rc3) for testing on testnet before the final production release.

## What's Changed

### v26.1.0-rc3

- Includes all fixes from v26.0.0-rc1
- Additional stability improvements from v25 release branch

### v26.0.0-rc1

#### ðŸ†• New Modules

**DKIM Module (DomainKeys Identified Mail)**

A complete Cosmos SDK module enabling on-chain verification of email authenticity through DKIM public key storage and cryptographic validation.

Core Capabilities:
- **Public Key Management**: Store and query DKIM public keys associated with domains and selectors
- **Poseidon Hashing**: Compute cryptographic hashes of public keys for efficient ZK proof verification
- **Email Subject Validation**: Validates email subjects from ZK-email proofs
  - Extracts subjects from proof public inputs (indices 43-52)
  - Blocks header injection attacks (rejects from:, to:, cc:, newlines in subjects)
  - Supports legitimate email prefixes (Re:, Fwd:) and [Reply Needed] tags
  - MIME/RFC 2047 decoding (UTF-8/base64) for international characters
- **Key Revocation System**: Revoke compromised keys with encoding-aware duplicate prevention
  - Stores both PKCS#1 and PKIX encodings to prevent re-adding revoked keys
  - Blocks re-registration under different domains/selectors
- **Governance Controls**: All key management operations secured through governance
- **Query Protection**: Pagination with max 1000 results per query to prevent resource exhaustion
- **Correct Field Extraction**: Properly extracts email host [34:43] and subject [43:52] ranges from ZK proof public inputs

CLI Tools:
- Generate DKIM records from DNS lookups
- Query keys by domain/selector or Poseidon hash
- Add, remove, and revoke DKIM public keys
- Module parameter inspection

gRPC/REST Endpoints:
- `Params`: Query module parameters
- `DkimPubKey`: Retrieve specific key by domain and selector
- `DkimPubKeys`: Filtered query with pagination support
- `UpdateParams`, `AddDkimPubKey`, `RemoveDkimPubKey`, `RevokeDkimPubKey`: Governance transactions

**ZK Module (Zero-Knowledge Proofs)**

New module for managing zero-knowledge verification keys and proof validation.

Features:
- **Verification Key Storage**: Store and manage ZK circuit verification keys
- **Parameter System**: Configurable limits for verification key sizes
  - Prevents spam through max key size enforcement
  - Gas metering for vKey operations
- **Authority-Gated Operations**: Verification key lifecycle management
  - Creators can upload vKeys
  - Only the original uploader can delete their vKeys
  - Tracks creator metadata for access control
- **Query Endpoints**: Retrieve parameters and verification keys

gRPC/REST Endpoints:
- `Params`: Query module parameters
- `UpdateParams`: Governance-controlled parameter updates
- Upload and delete verification keys (creator-gated)

#### ðŸ”’ Security Fixes

**CosmWasm Query Thread Safety**
- Fixed race conditions in stargate query whitelist (addresses CosmWasm/wasmd#2051)
- Replaced shared proto message instances with factory functions
- Each concurrent query now receives a fresh proto instance
- Prevents data corruption during simultaneous contract queries

**Input Validation Hardening**
- **WebAuthN**: Added size check for Credential field matching existing Data field protection
- **JWT Clock Validation**: Enhanced validateTimeOffset to reject int64 overflow values
- **Test Improvements**: Upgraded RSA key generation to 2048-bit (from 1024-bit)

**DKIM Module Security**
- Fixed unsafe type assertions preventing potential chain halt from non-RSA keys (ECDSA, etc.) in PKCS8/PKIX format
- Direct type assertions now use safe ok checks and return proper errors instead of panicking
- Added pagination limit cap to DkimPubKeys query (max 1000 results) to prevent resource exhaustion
- Removed deprecated ProofVerify endpoint stub (use Authenticate endpoint for ZK proof verification)

#### ðŸ”„ Improvements

**Application Integration**
- Integrated DKIM and ZK modules into main application
- Added upgrade handler for v26
- Registered new stargate whitelist queries for CosmWasm access
- Updated API documentation (OpenAPI/Swagger)

**Code Documentation**
- Added clarifying comments for DefaultBypassMinFeeMsgTypes
- Documented Send method behavior in Xion module

**Cleanup**
- Removed v25 upgrade tooling (CLI tools, analyzer, migrator)
- Updated test infrastructure and coverage configuration

#### ðŸ“‹ Module Structure

New Protobuf Definitions:
- `xion.dkim.v1`: Complete DKIM protocol (genesis, query, tx, state messages)
- `xion.zk.v1`: ZK verification protocol (genesis, query, tx, params messages)

## Upgrade Instructions

Validators should follow the standard upgrade procedure:

1. Wait for the upgrade height specified in the upgrade proposal
2. The chain will automatically halt at the upgrade height
3. Replace the binary with v26.0.0-rc1
4. Restart the node

## Binary Verification

After downloading binaries, verify the checksums match those listed in the release.

## Notes

This is a release candidate version intended for testnet validation. Please report any issues encountered during testing.

## Links

- [Release Page](https://github.com/burnt-labs/xion/releases/tag/v26.0.0-rc1)
- [Full Changelog](https://github.com/burnt-labs/xion/compare/v25.0.2...v26.0.0-rc1)
